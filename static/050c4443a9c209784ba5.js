"use strict";(self.webpackChunkcloud_trade_sdk=self.webpackChunkcloud_trade_sdk||[]).push([[858],{70858:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ve});var n=s(76398),i=s(58138),a=s(58107),o=s(88723),r=s(53066),l=s(87795),c=s(27008),d=s(51485),m=s(72249),h=s(96832),p=s(17776),u=s(2219);function x(e,t){const s=new Date,n=s.setHours(24,0,0,0),i=`get${e}`;return{startTime:s[`set${e}`](s[i]()-t),endTime:n}}const b={"1d":{label:"1 Day",getTimes:()=>x("Date",1)},"1w":{label:"1 Week",getTimes:()=>x("Date",7)},"1m":{label:"1 Month",getTimes:()=>x("Month",1)},"3m":{label:"3 Months",getTimes:()=>x("Month",3)}};var g=s(62600),y=s(67590),j=s(19805);const f=e=>(0,j.ZK)("trd-tradeTransaction",e);var w=s(49247),T=s(40721);const v=({children:e})=>(0,i.jsx)(w.Z,Object.assign({variant:"caption",__css:{color:"t.third"}},{children:e})),O=e=>{var{color:t="t.primary"}=e,s=(0,n._T)(e,["color"]);return(0,i.jsx)(w.Z,Object.assign({variant:"captionSub",color:t},s))},S=({children:e,sx:t})=>(0,i.jsx)(m.Z,Object.assign({className:"row-item",sx:t},{children:e})),M=({symbol:e,time:t,balanceDelta:s,balancetype:n,showSymbolColumn:i},a,o)=>{const r=[{columnKey:"amount",text:"Amount",i18n:"amount",value:s},{columnKey:"type",text:"Type",i18n:"type",value:a(`bt-${n}`,{defaultValue:n})},{columnKey:"time",text:"Time",i18n:"time",value:(0,T.v)(new Date(t),"yyyy-MM-dd hh:mm:ss")}];return i?[...r,{columnKey:"symbol",text:"Symbol",i18n:"symbol",value:e?(0,u.t9)(e,o):"-"}]:r},C=h.memo((e=>{const{getI18n:t}=f(),{getI18n:s}=(0,j.yk)(),n=M(e,t,s);return(0,i.jsxs)("div",Object.assign({className:"row-wrap"},{children:[(0,i.jsx)(S,Object.assign({sx:{pb:"10px !important"}},{children:e.asset})),n.map((({i18n:e,text:s,value:n,columnKey:a})=>(0,i.jsxs)(S,{children:[(0,i.jsx)(v,{children:t(e,{defaultValue:s})}),(0,i.jsx)(O,{children:n})]},a)))]}))})),Z=h.memo((e=>{const{getI18n:t}=f(),{getI18n:s}=(0,j.yk)(),n=M(e,t,s);return(0,i.jsxs)("div",Object.assign({className:"row-wrap"},{children:[(0,i.jsx)(S,Object.assign({sx:{pb:"10px !important"}},{children:e.asset})),(0,i.jsx)("div",Object.assign({className:"row-grid"},{children:n.map((({i18n:e,text:s,value:n,columnKey:a})=>(0,i.jsxs)("div",Object.assign({className:a},{children:[(0,i.jsx)(v,{children:t(e,{defaultValue:s})}),(0,i.jsx)(O,{children:n})]}),a)))}))]}))})),I={position:"relative",flexDirection:"column",flex:"1 0",".empty":{display:"flex",minHeight:120,alignItems:"center",justifyContent:"center",color:"t.secondary",fontSize:0},".row-wrap":{color:"t.primary",py:15,borderBottom:"1px solid",borderColor:"line","&:last-of-type":{mb:102,borderBottom:"none"},"& .row-item":{justifyContent:"space-between",alignItems:"center",py:"minor"}}},k={position:"relative",flexDirection:"column",height:"100%",".empty":{display:"flex",minHeight:120,alignItems:"center",justifyContent:"center",color:"t.secondary",fontSize:0},".row-list":{height:"calc(100% - 32px)",overflow:"auto","&::-webkit-scrollbar":{display:"none"},"&::-webkit-scrollbar-thumb":{bg:"transparent"}},".row-wrap":{color:"t.primary",py:15,borderBottom:"1px solid",borderColor:"line","&:last-of-type":{mb:15,borderBottom:"none"},".row-grid":{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gridTemplateRows:"repeat(2, 1fr)",gridGap:"12px 16px",gridTemplateAreas:'"amount type"\n        "time symbol"',"& .type, & .symbol":{textAlign:"right"}},"& .row-item":{justifyContent:"space-between",alignItems:"center"}}};var R=s(86282),P=s(77991),A=s(57546),W=s(87608),E=s.n(W);const D={ml:"16px",width:["176px","auto","176px"],borderRight:"1px solid",borderRightColor:"newLine",".filter-placeholder":{display:"flex",alignItems:"center",color:"t.third",fontSize:"14px",".filter-label":{maxWidth:"155px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}}},F={height:"312px",overflow:"auto",py:"4px",mt:"6px",bg:"modalBg",boxShadow:"elevation2",borderRadius:"4px",cursor:"pointer",".filter-option":{padding:"10px 16px",color:"t.primary","&:hover":{bg:"line"},"&.active":{color:"t.yellow"},fontSize:"14px"}},L=({balanceType:e,onFilterChange:t})=>{const{getI18n:s}=f();return(0,i.jsx)(R.Z,Object.assign({sx:D},{children:(0,i.jsx)(P.ZP,Object.assign({trigger:"click",enablePortal:!0,overlay:(0,i.jsx)(R.Z,Object.assign({sx:F},{children:u.Wm.map((n=>(0,i.jsx)("div",Object.assign({className:E()({"filter-option":!0,active:n===e}),onClick:()=>{t(n)}},{children:"ALL"===n?s("ALL",{defaultValue:"All"}):s(`bt-${n}`,{defaultValue:n})}),n)))}))},{children:(0,i.jsxs)("div",Object.assign({className:"filter-placeholder"},{children:[(0,i.jsx)("div",Object.assign({className:"filter-label"},{children:"ALL"===e?s("ALL",{defaultValue:"All"}):s(`bt-${e}`,{defaultValue:e})})),(0,i.jsx)(A.Z,{ml:"4px",color:"t.third",size:16})]}))}))}))};var N=s(12560),_=s(11204),B=s(83045),V=s(37375);const z=N.K3.transactionhistory,H=({onReset:e,type:t,endTime:s,startTime:n,onSearch:a,balanceType:o,onFilterChange:r})=>{const{isMobile:l}=(0,j.Fs)(),{getI18n:c}=(0,j.Vw)(),d="number"==typeof s&&"number"==typeof n;return l?(0,i.jsx)(V.Z,{onSearch:a,isTransaction:!0,onTransactionFilterChange:r}):(0,i.jsxs)(m.Z,Object.assign({sx:{alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",height:"32px"}},{children:[(0,i.jsx)(B.Z,Object.assign({withReset:!0,onReset:e,type:t,onSearch:a},{children:(0,i.jsx)(L,{balanceType:o,onFilterChange:r})})),d&&(0,i.jsx)(_.Z,{dateTime:{startTime:n,endTime:s},downloadUrl:z.uri,title:c(z.key)})]}))},K=()=>{const{getI18n:e}=f();return(0,i.jsx)("div",Object.assign({className:"empty"},{children:e("nodata",{defaultValue:"You have no trades."})}))},G=h.memo((({isMobile:e,isEmpty:t,hasMore:s,loadMore:n,showSymbolColumn:a,loading:o,data:r=[],filterType:l,balanceType:c,onFilterChange:d,onSearch:p,onReset:u})=>((0,h.useEffect)((()=>{s&&n()}),[s,n]),(0,i.jsxs)(m.Z,Object.assign({sx:e?I:k},{children:[(0,i.jsx)(g.Z,{fullScreen:!0,show:o}),(0,i.jsx)(H,{onReset:u,type:l,onSearch:p,balanceType:c,onFilterChange:d}),t?(0,i.jsx)(K,{}):e?r.map((e=>(0,i.jsx)(C,Object.assign({},e,{showSymbolColumn:a}),e.tranId))):(0,i.jsx)("div",Object.assign({className:"row-list"},{children:r.map((e=>(0,i.jsx)(Z,Object.assign({},e,{showSymbolColumn:a}),e.tranId)))})),s&&(0,i.jsx)(y.Z,{showMore:n,check:{offset:200},loading:o})]})))));var $=s(96056),U=s(35728),Q=s(21039);const Y=h.memo((({loading:e=!1,data:t,renderRow:s,empty:n,isEmpty:a,hasMore:o,loadMore:r,showSymbolColumn:l,rowHeight:c=80,minWidth:d=0,sx:m})=>{const u=(0,h.useRef)({data:t,flag:-1});u.current.data!==t&&(u.current.flag*=-1),u.current.data=t;const x=(0,h.useRef)(null),b=(0,p.tZ)(),y=(0,Q.cp)(b);(0,h.useEffect)((()=>{if(!x.current)return;const{listRef:e}=x.current;if(!e||!e.current)return;const{current:t}=e;t.resetAfterIndex(0,!0)}),[u.current.flag]);const j=(0,h.useMemo)((()=>[{title:"",dataIndex:"",hideTitle:!0,render:(e,t)=>s(e,t,l)}]),[l,s]);return a?(0,i.jsx)(h.Fragment,{children:n}):(0,i.jsxs)(R.Z,Object.assign({sx:Object.assign({position:"relative",".list-grid":{width:"100%","> div > div":{border:0,"> div":{my:0,px:0,height:"100%",borderBottom:"1px solid",borderBottomColor:"newLine"}}}},m)},{children:[(0,i.jsx)(g.Z,{fullScreen:!0,inner:!0,show:e}),(0,i.jsx)($.ZP,{children:({height:e,width:s})=>(0,i.jsx)(U.Z,{style:{direction:y},threshold:5,hasMore:o,loadMore:r,className:"list-grid",columns:j,ref:x,data:t,listGridConfig:{collapseHeight:c,height:Math.max(e-4,0),width:Math.max(s,d)},__hackDataChanged:u.current.flag})})]}))}));var q=s(54813);const X={my:0,py:"xs",width:"calc(100% - 5px)",display:"flex",alignItems:"center",flexGrow:0,flexShrink:0,color:"t.primary",fontSize:[0],cursor:"auto"},J={userSelect:"none",px:"xs",flexGrow:1,fontWeight:"normal",whiteSpace:"nowrap"},ee={time:{minWidth:"120px"},type:{minWidth:"90px"},amount:{minWidth:"100px"},asset:{minWidth:"50px"},symbol:{minWidth:"125px"}},te=Object.keys(ee).reduce(((e,t)=>e+parseInt(ee[t].minWidth,10)),0),se=e=>{const t=ee[e]||{};return Object.assign(Object.assign(Object.assign({},J),t),{flexBasis:t.minWidth})},ne=h.memo((({time:e,balanceDelta:t,balancetype:s,asset:n,symbol:a,showSymbolColumn:o})=>{const{getI18n:r}=f(),{getI18n:l}=(0,j.yk)();return(0,i.jsxs)(m.Z,Object.assign({sx:Object.assign(Object.assign({},X),{color:"t.primary",fontSize:[0],cursor:"auto",py:0,width:"100%"})},{children:[(0,i.jsx)(w.Z,Object.assign({sx:Object.assign(Object.assign({},se("time")),{color:"table.timeColor"})},{children:(0,T.v)(new Date(e),"yyyy-MM-dd hh:mm:ss")})),(0,i.jsx)(w.Z,Object.assign({sx:se("type")},{children:r(`bt-${s}`,{defaultValue:s})})),(0,i.jsx)(w.Z,Object.assign({sx:se("amount")},{children:(0,q.uf)(t,8)})),(0,i.jsx)(w.Z,Object.assign({sx:se("asset")},{children:n})),o?(0,i.jsx)(w.Z,Object.assign({sx:se("symbol")},{children:a?(0,u.t9)(a,l):"-"})):null]}))})),ie=[{key:"time",text:"Time",i18n:"time"},{key:"type",text:"Type",i18n:"type"},{key:"amount",text:"Amount",i18n:"amount"},{key:"asset",text:"Asset",i18n:"asset"}],ae=[...ie,{key:"symbol",text:"Symbol",i18n:"symbol"}],oe=(e,t,s)=>(0,i.jsx)(ne,Object.assign({},t,{showSymbolColumn:s})),re=()=>{const{getI18n:e}=f();return(0,i.jsx)(R.Z,Object.assign({sx:{color:"t.secondary",textAlign:"center",fontSize:[0],marginTop:"xs"}},{children:e("nodata",{defaultValue:"You have no trades."})}))},le=h.forwardRef((({isEmpty:e,hasMore:t,loadMore:s,showSymbolColumn:n,loading:a,data:o=[]},r)=>{const{getI18n:l}=f(),c=(0,h.useMemo)((()=>(0,i.jsx)(m.Z,Object.assign({sx:Object.assign(Object.assign({},X),{borderBottom:"1px solid",borderBottomColor:"newLine"})},{children:(n?ae:ie).map((e=>(0,i.jsx)(R.Z,Object.assign({sx:se(e.key)},{children:(0,i.jsx)(w.Z,Object.assign({sx:{fontSize:0,color:"t.third"}},{children:l(e.i18n,{defaultValue:e.text})}))}),e.key)))}))),[l,n]);return(0,i.jsxs)(m.Z,Object.assign({ref:r,sx:{flexDirection:"column",flex:"1 0",overflowX:"auto"}},{children:[c,(0,i.jsx)(Y,{sx:{flex:"1 0"},loading:a,rowHeight:40,renderRow:oe,data:o,hasMore:t,loadMore:s,showSymbolColumn:n,isEmpty:e,empty:(0,i.jsx)(re,{}),minWidth:te})]}))})),ce=h.memo((({filterType:e,onReset:t,onSearch:s,balanceType:n,onFilterChange:a,hasMore:o,loadMore:r,showSymbolColumn:l,isEmpty:c,data:d,loading:m,currentPage:p,endTime:x,startTime:b})=>{const g=function(e){const t=(0,h.useRef)(null);return(0,h.useEffect)((()=>{if(e!==u.li)return;const{current:s}=t;if(s&&s instanceof Element){const e=s.querySelector(".list-grid");e&&(e.scrollTop=0)}})),t}(p);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R.Z,{children:(0,i.jsx)(H,{onReset:t,type:e,endTime:x,startTime:b,onSearch:s,balanceType:n,onFilterChange:a})}),(0,i.jsx)(le,{ref:g,hasMore:o,loadMore:r,showSymbolColumn:l,isEmpty:c,data:d,loading:m})]})})),de=["TRANSFER","WITHDRAW","DEPOSIT"],me=["COIN_SWAP_WITHDRAW","COIN_SWAP_DEPOSIT"],he="Init",pe="UpdateFilter",ue="UpdateBalanceType",xe="FetchSuccess",be={nextPage:u.li,hasMore:!0,balanceType:"ALL",filters:{timePeriod:u.Bs,startTime:0,endTime:0},items:[],symbolMap:{}},ge=(0,o.j)({[he](e){const{symbolMap:t,items:s}=e;return Object.assign(Object.assign({},be),{items:s,symbolMap:t})},[ue](e,t){const{type:s}=t.payload;e.balanceType=s},[pe](e,t){const{startTime:s,endTime:n,timePeriod:i}=t.payload;void 0!==i&&(e.filters.timePeriod=i),void 0!==s&&(e.filters.startTime=s),void 0!==n&&(e.filters.endTime=n)},[xe](e,t){const{data:s,page:n}=t.payload;n===u.li?e.items=s:s.length&&(e.items=e.items.concat(s)),e.hasMore=s.length>0,e.nextPage=n+1}},be),ye=(0,r.Z)(pe),je=(0,r.Z)(ue),fe=(0,r.Z)(xe),we=(0,r.Z)(he);const Te=()=>()=>Promise.resolve(),ve=h.memo((({active:e=!1})=>{const t=(0,p.AM)(),[s,o]=(0,h.useReducer)(ge,Object.assign(Object.assign({},be),{symbolMap:t})),{nextPage:r,filters:x,hasMore:g}=s,{items:y=[],balanceType:j}=s;let f=(0,l.I9)(y);"TRANSFER"===j?f=y.filter((e=>-1!==de.indexOf(null==e?void 0:e.balancetype))):"COIN_SWAP"===j?f=y.filter((e=>-1!==me.indexOf(null==e?void 0:e.balancetype))):j&&"ALL"!==j&&(f=y.filter((e=>(null==e?void 0:e.balancetype)===j)));const w="ALL"===j||f.some((e=>null==e?void 0:e.symbol)),{startTime:T,endTime:v}=function(e){let t=function(e){const t=b[e];return t?t.getTimes():null}(e.timePeriod);return t||(t={startTime:e.startTime,endTime:e.endTime}),t}(x),[O,S]=(0,h.useState)(Te),[{loading:M},C]=(0,c.Z)((({page:e=u.li,times:t}={})=>(0,n.mG)(void 0,void 0,void 0,(function*(){const{startTime:s,endTime:i}=t||{startTime:T,endTime:v};if(S(Te),null===s||null===i)return;const{data:a}=yield(({startTime:e,endTime:t,rows:s,page:i}={})=>(0,n.mG)(void 0,void 0,void 0,(function*(){let n;try{n=yield(0,d.v_)("/bapi/futures/v1/private/future/user-data/transaction-history",{startTime:e,endTime:t-1,page:i,rows:s})}catch(e){throw new Error("nework error")}if("000000"!==n.code)throw new Error(n.message||"unknown error");return{data:n.data||[],total:n.total}})))({startTime:s,endTime:i,page:e,rows:u.n});o(fe({data:a,page:e}))}))),[T,v],{loading:!0});(0,h.useEffect)(((e,t)=>{let s;return(...t)=>{const n=+new Date;(!s||n-s>100)&&(e.call(null,...t),s=n)}})((()=>{S((()=>()=>C({page:r})))})),[C,r]);const Z=(0,h.useCallback)((({type:e,startTime:t,endTime:s})=>{o(ye({timePeriod:e,startTime:t,endTime:s})),C({page:u.li,times:{startTime:t,endTime:s}})}),[C]),I=e=>o(je({type:e})),k=()=>{o(we()),Z((0,l.OQ)("1d"))},R=!M&&y.length<=0;return(0,h.useEffect)((()=>{e&&Z((0,l.OQ)("1d"))}),[e]),(0,i.jsx)(m.Z,Object.assign({sx:{flexDirection:"column",height:"100%",pb:"xs",px:"sm"}},{children:(0,i.jsx)(a.Z,{children:({isMobile:e,isIPad:t})=>t?(0,i.jsx)(G,{isMobile:e,hasMore:g,loadMore:O,showSymbolColumn:w,isEmpty:R,data:f,loading:M,filterType:x.timePeriod,balanceType:j,onFilterChange:I,onReset:k,onSearch:Z}):(0,i.jsx)(ce,{filterType:x.timePeriod,onSearch:Z,balanceType:j,onFilterChange:I,onReset:k,hasMore:g,loadMore:O,showSymbolColumn:w,isEmpty:R,data:f,loading:M,currentPage:r-1,startTime:T,endTime:v})})}))}))},58107:(e,t,s)=>{s.d(t,{Z:()=>i});var n=s(7266);const i=({children:e})=>{const{isMobile:t,isIPad:s}=(0,n.F)();return e&&e({isMobile:t,isIPad:s})}},88723:(e,t,s)=>{s.d(t,{j:()=>a});var n=s(14035),i=s(25048);const a=(e,t)=>(0,n.Z)(Object.keys(e).reduce(((t,s)=>Object.assign(Object.assign({},t),{[s]:(t,n)=>(0,i.ZP)(t,(t=>e[s](t,n)))})),{}),t)}}]);