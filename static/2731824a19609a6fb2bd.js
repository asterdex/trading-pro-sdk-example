"use strict";(self.webpackChunkcloud_trade_sdk=self.webpackChunkcloud_trade_sdk||[]).push([[4661],{736:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(96832),o=n(415);const i=e=>a.createElement(o.Z,{width:"1em",height:"1em",fill:"currentColor",viewBox:"0 0 24 24",...e},a.createElement("path",{d:"M12 10.586l5.95-5.95a1 1 0 111.414 1.414L13.414 12l5.95 5.95a1 1 0 01-1.414 1.414L12 13.414l-5.95 5.95a1 1 0 01-1.414-1.414l5.95-5.95-5.95-5.95A1 1 0 016.05 4.636l5.95 5.95z"}))},39587:(e,t,n)=>{n.d(t,{C:()=>m,Z:()=>x});var a=n(58138),o=n(45313),i=n(49247),r=n(10600),s=n(18637),l=n(65871),c=n(71882),d=(n(96832),n(84619)),u=n(24029),p=n(35887);const h={className:"amount-input-container",sx:{height:"48px",width:"100%",bg:"bg3",mb:"20px","&.bn-input-status-error":{border:"none"},".bn-input-helper-text":{color:"errors",fontSize:"14px"}}};var m;!function(e){e[e.Deposit=1]="Deposit",e[e.Withdraw=2]="Withdraw"}(m||(m={}));const x=({value:e,onChange:t,available:n,maxWithdraw:x,realizedPnl:b,asset:g,type:f,precision:v=8,getI18n:j})=>{var w;const y=(0,u.w)({oldValue:e,precision:v}),C=Number(-1===x?n:Math.min(x,Number(n))),O=Number(e)>C,N=(null===(w=x.toString().split(".")[1])||void 0===w?void 0:w.length)||0;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",Object.assign({className:"amount-label"},{children:[(0,a.jsx)(o.Z,Object.assign({width:"auto"},{children:j("Amount")})),(0,a.jsxs)(i.Z,Object.assign({variant:"body2",color:"t.third"},{children:[j("Available"),(0,a.jsxs)(i.Z,Object.assign({ml:"4px",as:"span",variant:"subtitle2",color:"t.primary"},{children:[n," ",g]}))]}))]})),(0,a.jsx)(s.Z,{value:e,onChange:e=>t(y(e.currentTarget.value)),boxProps:h,variant:"outlineLarge",className:"amount-input",labelFixed:!0,error:O,suffix:(0,a.jsx)(r.Z,Object.assign({variant:"quiet",onClick:()=>{t((0,c.GW)(C,v).toString())}},{children:j("MAX")})),errorText:f===m.Withdraw?j("wallet-withdraw-amount-error",{defaultValue:"Please enter an amount less than the max withdrawal amount."}):j("wallet-deposit-amount-error",{defaultValue:"Please enter an amount less than the max deposit amount."})}),-1!==b&&g===d.J$&&(0,a.jsxs)("div",Object.assign({className:"amount-info",style:-1!==x?{marginBottom:"8px"}:{}},{children:[(0,a.jsx)(l.Z,Object.assign({arrow:!0,tip:j("wallet-withdraw-amount-24h-pnl-tip",{defaultValue:"Realized profits within 24 hours will be temporarily frozen and will be automatically unlocked over time."}),placement:"top",enablePortal:!0},{children:(0,a.jsx)(i.Z,Object.assign({color:"t.third",variant:"body2",sx:{cursor:"pointer",borderBottom:"1px dotted",borderColor:"t.third"}},{children:j("wallet-withdraw-amount-24h-pnl",{defaultValue:"24-hour realized profit"})}))})),(0,a.jsx)(i.Z,Object.assign({color:"t.primary",variant:"body2",sx:{textAlign:"right"}},{children:`${(0,p.Bz)(b,v).toString()} ${g}`}))]})),-1!==x&&(0,a.jsxs)("div",Object.assign({className:"amount-info"},{children:[(0,a.jsx)(i.Z,Object.assign({color:"t.third",variant:"body2",sx:{maxWidth:"186px"}},{children:j("wallet-remaining-withdraw-info-remaining",{defaultValue:"Daily withdrawal amount remaining"})})),(0,a.jsx)(i.Z,Object.assign({color:"t.primary",variant:"body2",sx:{textAlign:"right"}},{children:`${(0,p.uf)(x,N>8?8:N,3)} USD`}))]}))]})}},62646:(e,t,n)=>{n.d(t,{m:()=>r});var a=n(58138),o=(n(96832),n(27005));const i=new o.QueryClient({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:!1}}}),r=({children:e})=>(0,a.jsx)(o.QueryClientProvider,Object.assign({client:i},{children:e}))},44661:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var a=n(76398),o=n(58138),i=n(88927),r=n(49247),s=n(736),l=n(35116),c=n(77837),d=n.n(c),u=n(96832),p=n(29543),h=n(41270),m=n(71007),x=n(39587),b=n(84619),g=n(62646),f=n(85960),v=n(99986),j=n(56113),w=n(51029),y=n(3438),C=n(60265),O=n(82089);const N=({visible:e,onClose:t,defaultCoin:n,getI18n:c,sx:g={},dialogSx:N={},t:S,disabled:Z,onTransactionStart:k=(()=>null),top:D})=>{var T;const V=(0,h.h)(),[$]=(0,j.WS)(),M=(0,u.useRef)(n||b.J$),[I,B]=(0,u.useState)("0"),W=(()=>{const[,e]=u.useState({});return u.useCallback((()=>e({})),[])})(),A=(0,C.r9)(),E=(0,C.fF)(),z=(0,m._n)(),{approveButton:F,allowance:P,needApprove:R}=(0,O.j)({getI18n:c,coin:M.current,visible:e}),{data:_,refetch:G}=(0,v.i)(E&&z,M.current),{data:U,refetch:J}=(0,v.I)(E&&z),L=(null===(T=null==U?void 0:U.data)||void 0===T?void 0:T.reduce(((e,t)=>(e[t.asset]=Number(t.walletBalance),e)),{}))||{},H=(0,u.useCallback)((({coin:e,amount:n})=>(0,a.mG)(void 0,void 0,void 0,(function*(){if($){k({coin:e,amount:n});try{const a=yield $.getWalletBalance(M.current);if(B(a),Number(a)<Number(n))return void(0,l.i)({message:c("wallet-deposit-amount-error",{defaultValue:"Please enter an amount less than the max deposit amount."}),okText:c("dex-dialog-ok","Ok"),cancelText:""});$.deposit(e,n),t()}finally{}}}))),[$,c,t,k]),Y=(0,u.useMemo)((()=>d()((()=>(0,a.mG)(void 0,void 0,void 0,(function*(){if(!$)return;const e=yield $.getWalletBalance(M.current);B(e)}))),500)),[M,$]),q=(0,u.useCallback)((e=>{M.current=e,e?(Y(),W()):B("0")}),[Y,W]);(0,u.useEffect)((()=>{z&&e&&(Y(),E&&(G(),J()))}),[e,z,E,Y,G,J]),(0,u.useEffect)((()=>{M.current=n,e&&Y()}),[n,e]);const Q=(0,u.useMemo)((()=>A?[(0,o.jsx)(y.Y,{label:c("dex-deposit-to","Deposit to"),getI18n:c},"tradeType")]:[]),[c,A]);return(0,o.jsxs)(i.Z,Object.assign({sx:Object.assign(Object.assign({},w.i),N),visible:e},{children:[(0,o.jsxs)(r.Z,Object.assign({variant:"headline6",className:"title"},{children:[c("Deposit",{defaultValue:"Deposit"}),(0,o.jsx)(s.Z,{className:"close",onClick:t})]})),(0,o.jsx)(f.Z,{top:D,suffixFields:Q,available:I,defaultCoin:n,type:x.C.Deposit,onConfirm:H,onChangeCoin:q,getI18n:c,sx:g,residualDeposit:_,bottom:_&&_>=0?(0,o.jsx)(r.Z,Object.assign({variant:"body2",color:"t.secondary",mt:"16px"},{children:(0,o.jsx)(p.c,{t:S,i18nKey:"deposit-residual-hint",defaults:"You can have a maximum of {{maxDeposit}} {{coin}} in your account as margin asset.",values:{maxDeposit:_+L[M.current],coin:(0,h.D)(M.current,V)}})})):null,disabled:Z||R&&0===Number(P),confirmLabel:(null==$?void 0:$.supportTreasuryV2)?c("Deposit","Deposit"):void 0,prefixButtons:R&&0===Number(P)?[F]:[]})]}))},S=e=>{var{tradeType:t=C.v3.Futures,isSupportSpot:n=!0,sourceCode:i}=e,r=(0,a._T)(e,["tradeType","isSupportSpot","sourceCode"]);return(0,o.jsx)(g.m,{children:(0,o.jsx)(C.B9,Object.assign({tradeType:t,isSupportSpot:n,sourceCode:i},{children:(0,o.jsx)(N,Object.assign({},r))}))})}},82089:(e,t,n)=>{n.d(t,{j:()=>f});var a=n(76398),o=n(58138),i=n(96832),r=n(10600),s=n(73246),l=n(86282);const c={xl:{width:"18px",height:"48px",mr:"5px"},l:{width:"18px",height:"24px",mr:"5px"},m:{width:"18px",height:"24px",mr:"5px"},xs:{width:"18px",height:"12px",mr:"5px"}},d={":disabled:not(.inactive),:hover:not(:disabled):not(:active)":{backgroundColor:"button.defaultBg",backgroundImage:"none",borderColor:"t.third",color:"button.disableColor"}},u=(0,i.forwardRef)((({loading:e,children:t,sz:n="m",sx:a={},spinnerProps:o={},...u},p)=>{const h=c[n]||{},m=e?d:{},{sx:x={},...b}=o,g=(0,i.useCallback)(((...t)=>e?null:u.onClick&&u.onClick(...t)),[u.onClick,e]);return i.createElement(r.Z,{ref:p,sx:{...m,...a},disabled:e,sz:n,...u,onClick:g},e&&i.createElement(s.Z,{itemsColor:"button.disableColor",sx:{...h,...x},...b}),i.createElement(l.Z,{display:"inherit"},t))}));u.displayName="LoadingButton";const p=u;var h=n(93112),m=n(51285),x=n(56113),b=n(60265),g=n(59712);const f=({getI18n:e,coin:t,visible:n})=>{const{allowance:r,status:s,approve:l,needApprove:c}=((e,t)=>{const[n,o]=(0,i.useState)("0"),[r,s]=(0,i.useState)(1),[l,c]=(0,i.useState)(!0),[d,{isReady:u}]=(0,x.WS)(),p=(0,b.fF)(),f=(0,i.useRef)(),v=(0,h.D)((()=>(0,a.mG)(void 0,void 0,void 0,(function*(){if(!d||!p||!u)return;if(2===r)return window.clearTimeout(f.current),void(f.current=setTimeout(v,100));const t=yield d.isOrigin(e);if((0,m.unstable_batchedUpdates)((()=>{c(t),!t&&s(2)})),!t)try{const t=yield d.getOrInitAllowance(e);(0,m.unstable_batchedUpdates)((()=>{o(t),s(3)}))}catch(e){g.error("fetch allowance failed",e),s(3)}}))));(0,i.useEffect)((()=>{e&&u&&t&&(null==d?void 0:d.supportTreasuryV2)&&v()}),[e,u,v,t,null==d?void 0:d.supportTreasuryV2]);const j=(0,h.D)((()=>(0,a.mG)(void 0,void 0,void 0,(function*(){if(d&&!l&&(null==d?void 0:d.supportTreasuryV2)){s(2);try{yield d.approveAllowance(e);const t=yield d.getOrInitAllowance(e,!0);(0,m.unstable_batchedUpdates)((()=>{o(t),s(3)}))}catch(e){g.error("doApprove failed",e),s(3)}}}))));return window.reset=(0,h.D)((()=>null==d?void 0:d.approveAllowance(e,"0"))),(0,i.useMemo)((()=>({status:r,allowance:n,needApprove:p&&!l&&(null==d?void 0:d.supportTreasuryV2),approve:j})),[r,n,p,l,j,null==d?void 0:d.supportTreasuryV2])})(t,n);return(0,i.useMemo)((()=>({approveButton:0===Number(r)&&c&&(0,o.jsx)(p,Object.assign({loading:2===s,onClick:l},{children:e("deposit-approveEnableSymbol",{defaultValue:"Enable {{coin}}",coin:t})}),"approve-button"),allowance:r,needApprove:c})),[r,c,s,l,e,t])}},85960:(e,t,n)=>{n.d(t,{Z:()=>w});var a=n(58138),o=n(86282),i=n(10600),r=n(96832),s=n(41270),l=n(39587),c=n(16537),d=n(69612),u=n(56113),p=n(72249),h=n(51934);const m={color:"t.primary",justifyContent:"flex-start",alignItems:"center",flex:1,height:"100%",fontSize:"14px",".asset-code":{ml:"4px"},".asset-name":{ml:"4px",color:"t.third"}},x=({logo:e,code:t,name:n})=>(0,a.jsxs)(p.Z,Object.assign({sx:m},{children:[(0,a.jsx)(h.Z,{variant:"avatar",src:e,alt:"",width:16,height:16}),(0,a.jsx)("div",Object.assign({className:"asset-code"},{children:t})),(0,a.jsx)("div",Object.assign({className:"asset-name"},{children:n}))]}));var b=n(84619);const g=({value:e,onChange:t,getI18n:n})=>{const o=(0,u.v8)(),i=(0,s.h)(),l=(0,r.useCallback)((e=>{const t=o.find((t=>t.code===e));if(!t)return null;const n=(0,s.D)(t.code,i);return(0,a.jsx)(x,Object.assign({},t,{code:n,name:n}))}),[o,i]);return(0,r.useEffect)((function(){o.length&&!o.find((t=>t.code===e))&&t(o.find((e=>e.code===b.J$))?b.J$:o[0].code)}),[e,o,t]),(0,a.jsx)(c.Z,Object.assign({label:n("Coin",{defaultValue:"Coin"}),hideSearch:!0,onChange:e=>{t(e)},size:"lg",value:e,renderValue:l},{children:o.map((e=>{const t=(0,s.D)(e.code,i);return(0,a.jsx)(d.W,Object.assign({value:e.code},{children:(0,a.jsx)(x,Object.assign({},e,{name:t,code:t}))}),e.code)}))}))};var f=n(35887);const v={display:"flex",flexDirection:"column",justifyContent:"space-between",flex:1,".footer":{mt:"52px",textAlign:"right"},".confirm":{height:40,width:["100%",164]},".bn-sdd-noResults":{color:"t.secondary"},".amount-label":{justifyContent:"space-between",alignItems:"center",mb:"4px",lineHeight:"32px",display:"flex"},".amount-info":{display:"flex",flexDirection:"row",justifyContent:"space-between"}},j={display:"flex",justifyContent:"space-between",gap:"16px",button:{width:"100% !important"}},w=({available:e,maxWithdraw:t=-1,residualDeposit:n=-1,realizedPnl:c=-1,onChangeCoin:d,onConfirm:p,defaultCoin:h=b.J$,bottom:m=null,top:x=null,suffixFields:w=[],type:y,getI18n:C,sx:O={},disabled:N,confirmLabel:S,prefixButtons:Z=[]})=>{const k=(0,s.h)(),[D,T]=(0,r.useState)(""),[V,$]=(0,r.useState)(h),M=(0,u.W4)(V),I=(0,f.GW)(e,M).toString();let B=Number(I);t>=0?B=Math.min(Number(I),t):n>=0&&(B=Math.min(B,n));const W=N||!t||!Number(e)||!Number(D)||Number(D||0)>B;return(0,a.jsxs)(o.Z,Object.assign({sx:Object.assign(Object.assign({},v),O)},{children:[x,(0,a.jsxs)("div",{children:[w.map(((e,t)=>(0,a.jsx)(o.Z,Object.assign({mt:"24px"},{children:e}),t))),(0,a.jsx)(o.Z,Object.assign({mt:"24px"},{children:(0,a.jsx)(g,{value:V,onChange:e=>{d(e),$(e)},getI18n:C})})),(0,a.jsx)(o.Z,Object.assign({mt:"24px"},{children:(0,a.jsx)(l.Z,{realizedPnl:c,maxWithdraw:t,value:D,onChange:T,available:I,asset:(0,s.D)(V,k),type:y,getI18n:C,precision:M})}))]}),m,(0,a.jsxs)(o.Z,Object.assign({className:"footer",sx:Z.length>0?j:null},{children:[Z.length>0&&Z,(0,a.jsx)(i.Z,Object.assign({disabled:W,onClick:()=>p({coin:V,amount:D}),className:"confirm"},{children:S||C("Confirm")}))]}))]}))}},3438:(e,t,n)=>{n.d(t,{Y:()=>l});var a=n(58138),o=n(96832),i=n(16537),r=n(69612),s=n(60265);const l=({label:e,getI18n:t,onChangeType:n})=>{const{tradeType:l,setTradeType:c}=(0,s.Gt)(),d=(0,o.useMemo)((()=>[{label:t("dex-trade-type-spot",{defaultValue:"Spot"}),value:`${s.v3.Spot}`},{label:t("dex-trade-type-futures",{defaultValue:"Futures"}),value:`${s.v3.Futures}`}]),[t]),u=(0,o.useCallback)((e=>{const t=d.find((t=>t.value===e));return t&&t.label||""}),[d]),p=(0,o.useCallback)((e=>{c(Number(e)),setTimeout((()=>{n&&n()}))}),[]);return(0,a.jsx)(i.Z,Object.assign({size:"lg",renderValue:u,value:`${l}`,onChange:p,hideSearch:!0,label:e},{children:d.map((({value:e,label:t})=>(0,a.jsx)(r.W,Object.assign({value:`${e}`},{children:t}),`${e}`)))}))}},51029:(e,t,n)=>{n.d(t,{i:()=>a});const a={padding:"18px 24px 24px",width:["100%",420],height:["100%","auto"],minHeight:"400px",display:"flex",flexDirection:"column",bg:"modalBg",".title":{color:"t.primary",display:"flex",alignItems:"center",justifyContent:"space-between",pb:18,".close":{color:"icons.close",width:24,height:24,cursor:"pointer","&:hover":{color:"t.third"}}}}},24029:(e,t,n)=>{n.d(t,{w:()=>r});var a=n(35887);const o=/^\d+\.?\d*|%$/,i=/^0+(?=\d)/,r=({oldValue:e,maxValue:t,maxLength:n,precision:r})=>s=>!o.test(s)&&""!==s||isNaN(Number(s))?e:(s=s.replace(i,""),(0,a.N3)(s)>r&&(s=s.replace(new RegExp(`^(\\d*\\.\\d{${r}})\\d*`),"$1")),n&&s.split(".")[0].length>n&&(s=e),0===r&&(s=s.replace(".","")),t&&Number(s)>t&&(s=t.toString()),s)},35887:(e,t,n)=>{n.d(t,{Bz:()=>u,GW:()=>c,HV:()=>d,N3:()=>s,uf:()=>l});var a=n(71882),o=n(67997);const i=/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/,r=n.n(o)()(((e,t)=>new RegExp(`\\d(?=(\\d{${t||3}})+${e>0?"\\.":"$"})`,"g")),((...e)=>e.join(","))),s=e=>{const t=`${e}`.match(i);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},l=(e,t,n=3)=>{e="number"==typeof e?e:+e;const a=r(t,n);return e.toFixed(Math.max(0,~~t)).replace(a,"$&,")},c=(e,t=2,n)=>((e,t,n="round",a=!1)=>{const o=e||0;let i;const r=Math.pow(10,t);let s=(+o+1/Math.pow(10,t+3))*r;if("string"==typeof n){const e=2;s=parseInt(""+s*Math.pow(10,e),10)/Math.pow(10,e),c=n,i=(()=>{if(Math[c])return Math[c];throw new Error("getRoundFunc called with unknown type")})()}else i=n;var c;if("function"!=typeof i)throw new Error("decRound unknown rounding func");return a?l(i(s)/r,t):(i(s)/r).toFixed(t)})(e,t,"floor",n),d=(e,t)=>(0,a.Jp)(e).toFixed(Math.min(8,t),1),u=(e,t=2)=>new BigNumber(e).toFixed(t,3)},41270:(e,t,n)=>{n.d(t,{D:()=>u,h:()=>c});var a=n(96832),o=n(61975);const i={USDC:"USDC.e"},r={USDBC:"USDbC"},s={[o.yX.id]:i,421614:i,[o.J0.id]:r,8453:r};var l=n(85405);const c=()=>{const{chainId:e}=(0,l.dc)();return(0,a.useMemo)((()=>s[e]||{}),[e])},d=new Map,u=(e,t={})=>{var n;const a=e?null!==(n=d.get(e))&&void 0!==n?n:e:"";return t[a]||a}}}]);